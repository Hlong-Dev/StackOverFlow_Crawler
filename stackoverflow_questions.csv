How to send a sms with dedicated name per message to different numbers?,https://stackoverflow.com/questions/78828937/how-to-send-a-sms-with-dedicated-name-per-message-to-different-numbers,"I want to send a sms with dedicated name per message to different numbers this is my code.
var deviceId = ""95"";
var sheetName = ""Barcode Registration"";
var orderStatusColumn = 3; 
...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I want to send a sms with dedicated name per message to different numbers this is my code.</p>
<pre><code>var deviceId = ""95"";
var sheetName = ""Barcode Registration"";
var orderStatusColumn = 3; 
var OrderStatusUpdate = ""SEND"";
var NewOrderStatus = """";
var CustomerPhoneCol = 2;
var smsSentColumn = 8;
var msgNewOrder = encodeURIComponent('Magandang araw &lt;&lt;NAME&gt;&gt;, mula kay Mark Anthony Halili!\n\n Makiki-kumpirma sa staff kung natanggap mo ang mensaheng ito\n\n Maraming salamat!');
var msgConfirmedOrder = encodeURIComponent('Magandang araw &lt;&lt;NAME&gt;&gt;, mula kay Mark Anthony Halili!\n\n Makiki-kumpirma sa staff kung natanggap mo ang mensaheng ito\n\n Maraming salamat!');
  
  function OrderUpdated(e) {
  var sheet = e.source.getActiveSheet();
  var range = e.range;
  var row = range.getRow();
  var col = range.getColumn();

  
  if (col == orderStatusColumn) {  
    var status = sheet.getRange(row, col).getValue();

    if (status === OrderStatusUpdate) { 
      var PhoneNumber = sheet.getRange(row, CustomerPhoneCol).getValue(); 
      var link = ""https://app.sms8.io/services/send.php?key=""+ApiKey+""&amp;number=""+PhoneNumber+""&amp;message=""+msgConfirmedOrder+""&amp;devices=""+deviceId+""&amp;type=sms&amp;prioritize=0"";
      if (msgConfirmedOrder !== """") {

        try {
          var response = UrlFetchApp.fetch(link);
          Logger.log(""Response Code: "" + response.getResponseCode());
        } catch (error) {
          Logger.log(""Error fetching URL: "" + error);
          SpreadsheetApp.getUi().alert(""Message not sent"", error, SpreadsheetApp.getUi().ButtonSet.OK);
        }
      }
    }
  }
}
</code></pre>
<p>Please help me with my codes. I want to send a message with the name of the owner of the number I have it in my sheet.</p>
<p>here is the copy of my google sheet
<a href=""https://docs.google.com/spreadsheets/d/1a_xlmEZbUT3a3lgB2N0v98adCyE2BT_7ODw1hHoF5lk/copy"" rel=""nofollow noreferrer"">https://docs.google.com/spreadsheets/d/1a_xlmEZbUT3a3lgB2N0v98adCyE2BT_7ODw1hHoF5lk/copy</a></p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,-1,Bugsy,2024-08-03 14:28:22Z
Section completed multiple times,https://stackoverflow.com/questions/78822066/section-completed-multiple-times,I am a developer new to Google forms and have a form with multiple sections.  One section is collecting room information for a home. I would like the ability for the user to fill this section out for ...,"<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I am a developer new to Google forms and have a form with multiple sections.  One section is collecting room information for a home. I would like the ability for the user to fill this section out for each room with a question at the end of the section ""Do you have an additional room?"". At that point a blank section is displayed. When the form is submitted, I would like it to be stored on the same Google sheet row.</p>
<p>I know that I can create duplicates for this section for the max number of rooms. But, I am hoping that there is a better solution as I could have upward of 20 rooms.</p>
<p>I have tried using the navigation feature, but when it returns me to the forms Room section it is the same the initial room response, not a blank section.</p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,Rickyd56,2024-08-01 16:29:32Z
How to pull data from YouTube API to a Google Sheet with Apps Script [closed],https://stackoverflow.com/questions/78822598/how-to-pull-data-from-youtube-api-to-a-google-sheet-with-apps-script,I'm looking to create a Google sheet that can import the public data from YouTube into a Google Sheet and automatically update. Basically looking to pull similar  what SocialBlade.com does but in ...,"<div class=""s-prose js-post-body"" itemprop=""text"">
                    <div>
            <aside class=""s-notice s-notice__info post-notice js-post-notice mb16"" role=""status"">
        <div class=""d-flex fd-column fw-nowrap"">
            <div class=""d-flex fw-nowrap"">
                <div class=""flex--item wmn0 fl1 lh-lg"">
                    <div class=""flex--item fl1 lh-lg"">
                            <div>
                                <b>Closed</b>. This question needs to be more <a href=""/help/closed-questions"">focused</a>. It is not currently accepting answers.
                                
                            </div>
                    </div>
                </div>
            </div>
        </div>
            <hr class=""my12 outline-none baw0 bb bc-blue-400"">
        <div class=""fw-nowrap fc-black-500"">
            <div class=""d-flex fd-column lh-md"">
                <div class=""mb0 d-flex"">
                        <div class=""flex--item mr8"">
                            <svg aria-hidden=""true"" class=""svg-icon iconLightbulb"" width=""18"" height=""18"" viewbox=""0 0 18 18""><path d=""M15 6.38A6.5 6.5 0 0 0 7.78.04h-.02A6.5 6.5 0 0 0 2.05 5.6a6.3 6.3 0 0 0 2.39 5.75c.49.39.76.93.76 1.5v.24c0 1.07.89 1.9 1.92 1.9h2.75c1.04 0 1.92-.83 1.92-1.9v-.2c0-.6.26-1.15.7-1.48A6.3 6.3 0 0 0 15 6.37M4.03 5.85A4.5 4.5 0 0 1 8 2.02a4.5 4.5 0 0 1 5 4.36 4.3 4.3 0 0 1-1.72 3.44c-.98.74-1.5 1.9-1.5 3.08v.1H7.2v-.14c0-1.23-.6-2.34-1.53-3.07a4.3 4.3 0 0 1-1.64-3.94M10 18a1 1 0 0 0 0-2H7a1 1 0 1 0 0 2z""></path></svg>
                        </div>
                    <p><b>Want to improve this question?</b> Update the question so it focuses on one problem only by <a href=""/posts/78822598/edit"">editing this post</a>.</p>
                </div>
                    <div class=""mb0 mt6 d-flex"">
                        <p class=""ml24 pl2"">Closed <span title=""2024-08-02 00:25:07Z"" class=""relativetime"">yesterday</span>.</p>
                    </div>
                <div class=""ml24 pl2"">
            <p class=""mb0 mt12"">This post was edited and submitted for review <span title=""2024-08-02 14:32:31Z"" class=""relativetime"">yesterday</span>.</p>

                </div>
            </div>
        </div>
            <div class=""mt24 d-flex gsx gs8"">
                    <a class=""s-btn s-btn__outlined flex--item js-post-notice-edit-post"" href=""/posts/78822598/edit"">
                        Improve this question
                    </a>
            </div>
</aside>

    </div>

<p>I'm looking to create a Google sheet that can import the public data from YouTube into a Google Sheet and automatically update. Basically looking to pull similar  what SocialBlade.com does but in Google sheets.</p>
<p>Elements I'm looking to import: channel name, channel handle, # subscribers, pfp url, banner url, category, number of uploads, number of video views, channel creation date.</p>
<p>I saw <a href=""https://stackoverflow.com/questions/73805356/how-to-pull-data-from-youtube-api-to-a-google-sheet-with-channel-links"">this post</a> with a script posted by @benjamin-loison but the script only imported 3 items and I have not been able to get it to work for me. Here is that <a href=""https://docs.google.com/spreadsheets/d/1qo_t31xAH6jE76QZy2ha1UUJgsJxLGtUzdpAUqqWnnw/edit?usp=sharing"" rel=""nofollow noreferrer"">sample Google Sheet</a> and its code:</p>
<p></p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>// This Google Apps Script fills a Google Sheet with statistics associated to given YouTube channels.

// More precisely this script assumes that in columns A after the first row there are channel identifiers,
// which can be a channel ID (such as `UC0aMPje3ZACnQPKM_qzY0vw`) or any channel URL such as:
// - https://www.youtube.com/channel/UCK_cUZLMpibyRiIdp0uF-lQ
// - https://www.youtube.com/user/Fairphone
// - https://www.youtube.com/c/lemondefr

function fills_statistics_associated_to_given_youtube_channels() {
  const A = 1, B = 2, C = 3, D = 4;
  var sheet = SpreadsheetApp.getActiveSheet();
  const YOUTUBE_CHANNELS = YouTube.Channels;
  const CHANNEL_URL_PREFIX = ""https://www.youtube.com/"";
  // Consider an arbitrary number of channels written after the first row.
  for(var row = 2; row &lt;= sheet.getLastRow(); row++)
  {
    const channelURL = sheet.getRange(row, A).getValue().toString().replace(CHANNEL_URL_PREFIX, """");
    // Retrieve the channel ID from the channel identifier provided.
    // If the channel URL provided is an username-based one, obtain the associated channel ID.
    var channelID;
    if(channelURL.startsWith(""user/""))
      channelID = YOUTUBE_CHANNELS.list(""id"", {""forUsername"": channelURL.replace(""user/"", """")}).items[0].id;
    // As YouTube Data API v3 Channels: list `forUsername` filter doesn't work for this kind of URL, proceed with a YouTube UI reverse-engineering approach.
    // This approach consists in obtaining JSON encoded JavaScript `ytInitialData` from the HTML code of the YouTube UI channel.
    else if(channelURL.startsWith(""c/""))
    {
      // Note that the following reverse-engineering method isn't working currently because of escaped JSON syntax and I haven't found any clean way to parse it correctly.
      /*
      const channelHTML = UrlFetchApp.fetch(CHANNEL_URL_PREFIX + channelURL).getContentText();
      const ytInitialDataStr = channelHTML.split('""&gt;var ytInitialData = ', 2)[1].split("";&lt;/script&gt;"", 1)[0];
      const ytInitialDataJSON = JSON.parse(ytInitialDataStr);
      channelID = ytInitialDataJSON[""responseContext""][""serviceTrackingParams""][0][""params""][6][""value""];
      continue;
      */

      // However by relying on a YouTube operational API instance doing this reverse-engineering method, it works fine. Nevertheless if YouTube servers detect the instance as suspicious, you have to host your own instance cf below. If you go this way, replace `yt.lemnoslife.com` to your instance hostname.
      // YouTube operational API source code is available at: https://github.com/Benjamin-Loison/YouTube-operational-API
      const channelStr = UrlFetchApp.fetch(""https://yt.lemnoslife.com/channels?part=snippet&amp;cId="" + channelURL.replace(""c/"", """")).getContentText();
      const channelJSON = JSON.parse(channelStr);
      channelID = channelJSON[""items""][0][""id""];
    }
    // Not filtering with `if(channelURL.startsWith(""channel/""))` in order to support channel ID too.
    else
      channelID = channelURL.replace(""channel/"", """");
    // For more details see YouTube Data API v3 Channels: list endpoint documentation: https://developers.google.com/youtube/v3/docs/channels/list
    // Note that the channel ID retrieval can't be optimized in terms of HTTPS requests.
    // However could optimize the other HTTPS requests to YouTube Data API v3 by implementing using `id` filter to provide up to 50 channel IDs as documented by `maxResults`.
    const statistics = YOUTUBE_CHANNELS.list(""statistics"", {""id"": channelID}).items[0].statistics;
    sheet.getRange(row, B).setValue(statistics.subscriberCount);
    sheet.getRange(row, C).setValue(statistics.viewCount);
    sheet.getRange(row, D).setValue(statistics.videoCount);
  }
}</code></pre>
</div>
</div>

    </div>",chưa có câu trả lời,không có câu trả lời,0,-1,RobertK,2024-08-01 18:39:35Z
Record unique values from a Google Sheets column (even if data changes) and copy that data to another sheet,https://stackoverflow.com/questions/78823573/record-unique-values-from-a-google-sheets-column-even-if-data-changes-and-copy,"sorry I am new to scripting. I am trying to record the values from a column in a Google Sheet. This data is dynamic and changes every month via an importrange.
I would like to record the all-time list ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>sorry I am new to scripting. I am trying to record the values from a column in a Google Sheet. This data is dynamic and changes every month via an importrange.</p>
<p>I would like to record the all-time list of the values in this column and not just the current(live) values.</p>
<p>So basically when the data changes once a month I would like a column in another sheet to be populated with any new and unique values in the new data while retaining the unique values from the previous months.</p>
<p>I have tried this script but it only updates based on the live data. I need it to copy the unique data instead and retain it.</p>
<pre><code>    const getUnique_ = array2d =&gt; [...new Set(array2d.flat())];
    const uniquifyAColumn = (sheetName = 'Sheet1', column = 1, headers = 1) =&gt; {
      const sh = SpreadsheetApp.getActive().getSheetByName(sheetName),
      rg = sh.getRange(1 + headers, column, sh.getLastRow() - headers, 1),
      values = rg.getValues(),
      uniqueValues = getUnique_(values).map(e =&gt; [e]);
    rg.offset(0, 1, uniqueValues.length).setValues(uniqueValues);
    };
</code></pre>
<p>My current data looks something like this</p>
<div class=""s-table-container""><table class=""s-table"">
<thead>
<tr>
<th>Column A</th>
<th>Column B</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td></td>
</tr>
</tbody>
</table></div>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,paddyloco,2024-08-02 02:16:52Z
Apps Script to add timestamp based on importfile from another sheet,https://stackoverflow.com/questions/78823814/apps-script-to-add-timestamp-based-on-importfile-from-another-sheet,"I need help to add a timestamp to B2 in TIMESTAMP sheet if I imported CSV file in IMPORT FMS Sheet, I want to know when the last time my colleagues update the sheet
I'm not an expert using AppsScript ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I need help to add a timestamp to B2 in TIMESTAMP sheet if I imported CSV file in IMPORT FMS Sheet, I want to know when the last time my colleagues update the sheet
I'm not an expert using AppsScript but I gathered info from internet, and I managed to add basic timestamp to it</p>
<pre><code>function onEdit(e){

  var row = e.range.getRow();
  var col = e.range.getColumn();

  if(col == 1 &amp;&amp; row &gt; 1 &amp;&amp; e.source.getActiveSheet().getName() == ""TIMESTAMP""){

    var currentDate = new Date();
    e.source.getActiveSheet().getRange(2,2).setValue(currentDate);
  }
}
</code></pre>
<p>But the problem, it won't work based on Imported file, instead it works only if I edited cell A2 in TIMESTAMP sheet manually (typing or copy paste from certain cell in IMPORT FMS sheet)
Here is the <a href=""https://docs.google.com/spreadsheets/d/1prAbxVjpkD88NJHpGpmxfk1jgjncq__Bvv0EpAWDW80/edit?usp=sharing"" rel=""nofollow noreferrer"">Sample Sheet</a> and here is the <a href=""https://drive.google.com/file/d/16AzFiTjUlwyV1QFaM0XRgfA-hFauc7jT/view?usp=drive_link"" rel=""nofollow noreferrer"">Test File</a> that I want to import</p>
<p>I'm expecting if I import (File &gt; Import then Replace Current Sheet) the TEST FILE in IMPORT FMS sheet, a timestamp will appear on B2 in TIMESTAMP sheet based on changed in cell A2 in TIMESTAMP sheet (cell A2 in TIMESTAMP sheet is linked to A2 in IMPORT FMS sheet)
So if I import another file later on, the value on A2 in IMPORT FMS sheet will also change with new value so will with cell A2 in TIMESTAMP sheet because it linked to A2 in IMPORT FMS sheet Thank you for your help
Here is the Sample Sheet and here is the Text File that I want to import
Thank you for your help</p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,1,Octo Aristoteles,2024-08-02 04:47:50Z
Using the Query function in Google Sheets to QUERY a range and find matches to a range of cells,https://stackoverflow.com/questions/78823956/using-the-query-function-in-google-sheets-to-query-a-range-and-find-matches-to-a,"I have a sheet with a large array of data in google-sheet. I want to QUERY data and match one column of that data to values in an array of cells
I have used various variations of the formula and only ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I have a sheet with a large array of data in google-sheet. I want to QUERY data and match one column of that data to values in an array of cells</p>
<p>I have used various variations of the formula and only get matching data from W14, not the range W14:W</p>
<p>I have tried</p>
<pre><code>=ARRAYFORMULA(QUERY(UNFILTERED!A14:W, ""SELECT A WHERE Q MATCHES '""&amp;W14:W&amp;""'""))
</code></pre>
<pre><code>=(QUERY(UNFILTERED!A14:W, ""SELECT A WHERE Q MATCHES '""&amp;W14:W&amp;""'"")
</code></pre>
<pre><code>=(QUERY(UNFILTERED!A14:W, ""SELECT A WHERE Q MATCHES '""&amp;$W14:$W&amp;""'"")
</code></pre>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,Mark,2024-08-02 05:55:52Z
Error: 429 Resource has been exhausted (e.g. check quota),https://stackoverflow.com/questions/78825113/error-429-resource-has-been-exhausted-e-g-check-quota,"I get an error like this and it doesn't give it all the time. I stated as a prompt that it is a translation application, and while some translations are good, I get this error in others: Error: 429 ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I get an error like this and it doesn't give it all the time. I stated as a prompt that it is a translation application, and while some translations are good, I get this error in others: Error: 429 Resource has been exhausted (e.g. check quota). I don't fully understand it, and sometimes it gives the following error: Error: Invalid operation: The <code>response.text</code> quick accessor requires the response to contain a valid <code>Part</code>, but none were returned. Please check the <code>candidate.safety_ratings</code> to determine if the response was blocked.
Also, if my quota is exhausted, why does the translation continue for some words?</p>
<p>def translate_text_gemini(text, source_lang, target_lang):
# Boş veya NaN (pd.NA) durumunda metni döndür.
if pd.isna(text) or text == '' or text == '**':
return text</p>
<pre><code>try:
    # Modeli dışarda bir kere tanımlayıp tekrar kullanılabilir hale getirebilirsiniz.
    model = genai.GenerativeModel('gemini-1.5-flash')
    
    prompt = (f""Act like a language translation application. Translate the following text from {source_lang} to {target_lang}. Just write the translation equivalents, do not make any comments.""
              f""The text provided is purely for translation purposes and does not contain offensive or inappropriate content.""
              f""Make sure the translation is accurate and does not reflect any negative sentiments or inappropriate language.""
              f""Text: {text}"")
              
    # Çeviri isteği yapılıyor.
    response = model.generate_content(prompt)
    
    # Dönen yanıtı kontrol ediyoruz.
    if response and hasattr(response, 'text'):
        return response.text.strip()  # Strip ile gereksiz boşlukları kaldırıyoruz.
    else:
        return 'Translation failed or empty response'

except Exception as e:
    # Hata durumunda hata mesajını döndürüyoruz.
    return f""Error: {str(e)}""
</code></pre>
<p>source_lang='tr'
target_lang='en'
existing_df['Gemini'] = existing_df['Türkçe-TR'].apply(lambda x: translate_text_gemini(x, source_lang, target_lang))
gd.set_with_dataframe(sheet, existing_df)</p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,SÜLEYMAN YAŞAR,2024-08-02 10:58:15Z
App Script Runtime Issue: Exception: Document is missing,https://stackoverflow.com/questions/78825367/app-script-runtime-issue-exception-document-is-missing,This is my first time running app script. I have the following code to extract a bookmarked section from a google doc into a cell in google sheet. I made both the google doc and google sheet public &...,"<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>This is my first time running app script. I have the following code to extract a bookmarked section from a google doc into a cell in google sheet. I made both the google doc and google sheet public ""anyone with the link can access"". However, when I ran it, it says ""Exception: Document is missing (perhaps it was deleted, or you don't have read access?)"" What am I doing wrong? I tried making both the sheet and doc public so anyone with the link can access. Still getting the same error.</p>
<pre><code>function getTextFromDoc() {
  var docId = 'https://docs.google.com/document/d/1KuEhKWTCqLY4mlT1cUHLU3sQbVR2wuS6-QPo8XUFvzw/edit?usp=sharing'; // Replace with your Google Doc ID
  var bookmarkId = 'https://docs.google.com/document/d/1KuEhKWTCqLY4mlT1cUHLU3sQbVR2wuS6-QPo8XUFvzw/edit?pli=1#bookmark=id.mfymbqmkxh1i'; // Replace with your Bookmark ID
  var doc = DocumentApp.openById(docId);
  var bookmarks = doc.getBookmarks();
  
  for (var i = 0; i &lt; bookmarks.length; i++) {
    if (bookmarks[i].getId() === bookmarkId) {
      var startElement = bookmarks[i].getPosition().getElement();
      var body = doc.getBody();
      var text = '';
      var started = false;

      // Iterate through all elements in the document
      for (var j = 0; j &lt; body.getNumChildren(); j++) {
        var element = body.getChild(j);
        if (element === startElement) {
          started = true;
        }
        if (started) {
          if (element.getType() === DocumentApp.ElementType.PARAGRAPH) {
            text += element.asParagraph().getText() + '\n';
          } else if (element.getType() === DocumentApp.ElementType.TEXT) {
            text += element.asText().getText() + '\n';
          }
          // Stop at the next heading or the end of the document
          if (element.getType() === DocumentApp.ElementType.PARAGRAPH &amp;&amp; element.asParagraph().getHeading() !== DocumentApp.ParagraphHeading.NORMAL) {
            break;
          }
        }
      }
      // Paste text into Google Sheet
      var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
      sheet.getRange('A1').setValue(text.trim()); // Set the content in cell A1
      break;
    }
  }
}


</code></pre>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>The problem is that the script is using
openById but the document URL instead of the id is passed as parameter. Use openByUrl.</p>
    </div>",không có câu trả lời,1,0,Ingrid Koh,2024-08-02 11:54:55Z
Function in google sheets that will display a drop down if a cell is populated,https://stackoverflow.com/questions/78825901/function-in-google-sheets-that-will-display-a-drop-down-if-a-cell-is-populated,"Could anyone provide some assistance on writing a function a function in google sheets such that, when a value is populated in one of the rows in column A, that a drop down list appears in same row in ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>Could anyone provide some assistance on writing a function a function in google sheets such that, when a value is populated in one of the rows in column A, that a drop down list appears in same row in column H.
The dropdown will be the same for everyone who populates column and only has the values Yes, No and Not sure.</p>
<p>I can see things on who to do this using xlookup and others, but I really want this to be a function so people can't access it result in them messing it up as I'll deny access permissions to the functions.</p>
<p>I'm really struggling on this and that gets returned is conditional lookups which isn't what I want in this case, and it should only appear when populated others if it is empty, or populated then deleted then it should clear.</p>
<p>If anyone can provide a start, that would be great as I like to try and learn myself, but I just can't find a starting point for this.</p>
<p>Thanks very much</p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,user1663003,2024-08-02 14:12:15Z
Formula to calculate date in one cell for after 8/1/24 and going back 60 days,https://stackoverflow.com/questions/78826262/formula-to-calculate-date-in-one-cell-for-after-8-1-24-and-going-back-60-days,"Trying to figure out a formula to calculate 60 days back starting 8/1/24 but continue to look back after 60 days from 8/1/24
=""8/1/2024""-60
=and(today()-60,"">="" ""8/1/2024&...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>Trying to figure out a formula to calculate 60 days back starting 8/1/24 but continue to look back after 60 days from 8/1/24</p>
<p>=""8/1/2024""-60</p>
<p>=and(today()-60,""&gt;="" ""8/1/2024"")</p>
<p>=and(today()-60,""&gt;=""datevalue(""8/1/2024""))</p>
<p>=and(today()+60,&gt;=datevalue(""8/1/2024""))</p>
<p>expected the outcome to look back 60 days with the caveat that it be starting 8/1/24</p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,-1,Google Sheetssss,2024-08-02 15:40:29Z
Prefilled Google Form always adds 4 hours to the datetime object,https://stackoverflow.com/questions/78826842/prefilled-google-form-always-adds-4-hours-to-the-datetime-object,"I have a script that creates a prefilled form link for users to edit. There is a datetime question in that form that, no matter what I do, always seems to assume I'm in the UTC time zone instead of ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I have a script that creates a prefilled form link for users to edit. There is a datetime question in that form that, no matter what I do, always seems to assume I'm in the UTC time zone instead of New York/UTC-4, as it's adding 4 hours to the prefilled datetime object. e.g., when the prefilled form is accessed, the datetime question is always 4 hours later than the actual input being supplied.</p>
<p>I've double-checked the time zone settings for the sheet as well as for the script, and they're both set correctly to US Eastern/New York. Is there any way to correct this without manually subtracting time from the datetime object before submitting the form answer?</p>
<pre class=""lang-js prettyprint-override""><code>  //Populate Timestamp
  formItem = formItems[0].asDateTimeItem();
  response = formItem.createResponse(new Date(data[1]));  //data[1] is a datetime string in UTC-4
  formResponse.withItemResponse(response);
</code></pre>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,Joshua Pelton-Stroud,2024-08-02 18:46:25Z
Make a vertical date list by month and weeks of the year on google sheets,https://stackoverflow.com/questions/78826854/make-a-vertical-date-list-by-month-and-weeks-of-the-year-on-google-sheets,"I am trying to make a calendar list that shows the months, week numbers, and the day numbers within the month and the weeks.  Where there is information in one column, I don't want any info in the ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I am trying to make a calendar list that shows the months, week numbers, and the day numbers within the month and the weeks.  Where there is information in one column, I don't want any info in the other columns, meaning the row only has one piece of information.  Here is a spreadsheet that can be manipulated as it's a copy: <a href=""https://docs.google.com/spreadsheets/d/1EKpSzuT0_pUytBCaga80LWExRNqDcuh2iGrV5Rg_hdA/edit?usp=sharing"" rel=""nofollow noreferrer"">https://docs.google.com/spreadsheets/d/1EKpSzuT0_pUytBCaga80LWExRNqDcuh2iGrV5Rg_hdA/edit?usp=sharing</a></p>
<p>I was filling this out manually, but I know that there is a way to autopopulate, but can't figure it out.  I have formulas to fill out other calendars and such, but the jumps in the info is throwing me off.</p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
 
<p><em>Here's one generalized approach which you may improvise on:</em></p>
<pre class=""lang-js prettyprint-override""><code>=let(start_,date(2024,7,1), end_,date(2024,12,31), Λ,sequence(end_-start_+1,1,start_), Σ,index(hstack(text(Λ,""mmmm""),weeknum(Λ),Λ)),
 reduce(tocol(,1),unique(index(Σ,,1)),lambda(a,c,ifna(vstack(a,c,reduce(tocol(,1),unique(filter(index(Σ,,2),index(Σ,,1)=c)),lambda(f,q,vstack(f,
 if(min(filter(Λ,weeknum(Λ)=q))=+filter(index(Σ,,3),index(Σ,,2)=q,index(Σ,,1)=c), hstack(,q,),tocol(,1)),hstack(,,filter(day(index(Σ,,3)),index(Σ,,2)=q,index(Σ,,1)=c))))))))))
</code></pre>
<p><a href=""https://i.sstatic.net/VjP0S4th.png"" rel=""nofollow noreferrer""><img src=""https://i.sstatic.net/VjP0S4th.png"" alt=""enter image description here""></a></p>
    </div>",không có câu trả lời,1,0,Tiffany Aguirre,2024-08-02 18:50:10Z
Google Sheets - How do I split a list of strings and find all the matches in another column with the strings,https://stackoverflow.com/questions/78827116/google-sheets-how-do-i-split-a-list-of-strings-and-find-all-the-matches-in-ano,"I have a column with of strings joined with "","" with an example being ""john,dora,sally"" and in two other columns I have individual names and salary with examples being ""john&...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I have a column with of strings joined with "","" with an example being ""john,dora,sally"" and in two other columns I have individual names and salary with examples being ""john"" and 25 respectively.</p>
<p>How do I split the first string to find the matches in the name column and get the output as the sum of all the matches' salaries?</p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>Click Extensions / Apps Script, paste this code in, click save.</p>
<p><strong>Spreadsheet must have colA is name, colB is salary, colC is your list of names, e.g. ""john, sally"".</strong></p>
<p>Put your cursor in colD and type <code>=SUMSALARIES(</code> then click in cell to left (cell in colC) and press ENTER.</p>
<p><img src=""https://i.sstatic.net/ebTSflvI.png"" alt=""""></p>
<pre><code>/**
 * @param {range}
 * @customfunction
 */
function SUMSALARIES(cell1) {
  const sheet = SpreadsheetApp.getActiveSheet();
  const people = cell1.split("","");
  const salaryArray = getValuesFromColumnsAandB();

  return sumSalariesOf(people);

  function sumSalariesOf(arr) {
    let total = 0;
    try {
      arr.forEach(function(person){
        total = total + salaryOf(person);
      })
      return total;
    } catch {

    }
  }

  function findNameIndex(name) {
    return function(item) {
      return item[0] === name;
    };
  }

  function salaryOf(name){
    let i = salaryArray.findIndex(findNameIndex(name));
    if(i&gt;-1){
      return salaryArray[i][2];
    } else {
      return 0;
    }
  }

  function getValuesFromColumnsAandB() {
    const dataRange = sheet.getDataRange();
    const values = dataRange.getValues();
    // Extract values from columns A and B
    const columnABValues = values.map(row =&gt; [row[0], row[2]]);
    return columnABValues;
  }
}
</code></pre>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>You most likely need split the data, rearrange the data into a single column of values, and then match with VLOOKUP.</p>
<ul>
<li>The <a href=""https://support.google.com/docs/answer/3094136"" rel=""nofollow noreferrer"">SPLIT</a> function can be used to breakup the data into separate columns based on a delimiter such as a comma.</li>
<li>The <a href=""https://support.google.com/docs/answer/3093318?hl=en"" rel=""nofollow noreferrer"">VLOOKUP</a> function can be used to match data in a separate sorted table and return another column's matched value.</li>
<li>If you expect to have one name in the first set of data and many matching salary values for an individual name, then you will likely want to use a <a href=""https://support.google.com/docs/answer/3093583?hl=en"" rel=""nofollow noreferrer"">SUMIF</a> function instead of VLOOKUP.</li>
</ul>
<p>The following is an example of just using SPLIT and VLOOKUP without rearranging the data into a single column of values.</p>
<p><a href=""https://i.sstatic.net/z1I2jWs5.png"" rel=""nofollow noreferrer""><img src=""https://i.sstatic.net/z1I2jWs5.png"" alt=""Screenshot of Google Sheets with sample data and functions""></a></p>
<ul>
<li>The first column shows a few rows of comma-delimited values.</li>
<li>The next set of columns are the output of using the SPLIT function.</li>
<li>The columns on the right are the values returned when using a VLOOKUP for the split columns.</li>
<li>The table in the bottom is a sample set of salary data used for the VLOOKUP.</li>
</ul>
    </div>",2,0,Ayman.1302,2024-08-02 20:17:58Z
Google Sheets App script: OnEdit doesn't work on cells with formula,https://stackoverflow.com/questions/78828509/google-sheets-app-script-onedit-doesnt-work-on-cells-with-formula,"function onEdit(e) {
  if (!e) return;
  var range = e.range;
  var sheet = range.getSheet();
  
  var SheetName = ""Civilian"";
  
  if (sheet.getName() === SheetName) {
    var editedCell = ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<pre><code>function onEdit(e) {
  if (!e) return;
  var range = e.range;
  var sheet = range.getSheet();
  
  var SheetName = ""Civilian"";
  
  if (sheet.getName() === SheetName) {
    var editedCell = range.getA1Notation();
    
    if (editedCell === ""J5"") {
      var oldValue = e.oldValue;

      if (oldValue === undefined) {
        oldValue = '';
      }

      sheet.getRange(""K5"").setValue(oldValue);
    }
  }
}
</code></pre>
<p>The script above is meant to check if J5 is edited. If edited, its previous value is to be updated to K5. However, since J5 has a formula, it's not working.</p>
<p>Is there a workaround to this?</p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,ApertureGaming011,2024-08-03 10:56:44Z
Filtering Data that has already been filtered down to 1 column returns error,https://stackoverflow.com/questions/78813716/filtering-data-that-has-already-been-filtered-down-to-1-column-returns-error,"I'm having a situation in a Google Sheet where data that has already been filtered down to 1 column is returning an error, even if the next level of filtering is correct.
So, for example, I have 4 ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I'm having a situation in a Google Sheet where data that has already been filtered down to 1 column is returning an error, even if the next level of filtering is correct.</p>
<p>So, for example, I have 4 rows of data where I'm filtering out columns if there is no value in the qty row.
<a href=""https://i.sstatic.net/T0EVsCJj.png"" rel=""nofollow noreferrer""><img src=""https://i.sstatic.net/T0EVsCJj.png"" alt=""enter image description here""></a></p>
<p>Then, I'm further filtering that data based on the ""Type"" row, which generally works just fine. Here is basically an isolated part of my larger formula:</p>
<p>LET(frData, FILTER(rowData, rowQtys &lt;&gt; """"), FILTER(frData, CHOOSEROWS(frData, 3) = ""Orange""))</p>
<p>This works just fine when the frData has more than one column in it. The problem is, if frData has been filtered down to one column of data, even though the above filter formula should be true, because CHOOSEROWS(frData, 3) DOES equal ""Orange"", it is throwing the error  ""FILTER has mismatched range sizes. Expected row count: 4. column count: 1. Actual row count: 1, column count: 1.""</p>
<p>I've been getting around this by adding a blank column of data to frData so that it is always at least 2 columns wide, but this feels like a hack that I might not remember why I'm doing it if I come back to the formula months from now:</p>
<p>LET(frData, {FILTER(rowData, rowQtys &lt;&gt; """"), {b;b;b;b}},....</p>
<p>Any thoughts on what I'm doing wrong?</p>
<p>And BTW, what I'm NOT looking for is some IF/ELSE where it says
IF(COLUMNS(frData) = 1, do it a different way, do it the regular way)
That will just bloat my formula.</p>
<p>Thanks!</p>
<p>Here is maybe a better look at how you can recreate what I mean:
In the formula in the image below, change B1:B4 to B1:C4 and it works just fine.</p>
<p><a href=""https://i.sstatic.net/V0gBIXAt.png"" rel=""nofollow noreferrer""><img src=""https://i.sstatic.net/V0gBIXAt.png"" alt=""enter image description here""></a></p>
<p>Thanks!!!</p>
<p>EDIT: here is a link to a sheet that has example code
<a href=""https://docs.google.com/spreadsheets/d/1Z6JlNQ0VRNswUWdqAK9Nr5h3oAInd6HCRH7nGAob6EY/edit?gid=0#gid=0"" rel=""nofollow noreferrer"">https://docs.google.com/spreadsheets/d/1Z6JlNQ0VRNswUWdqAK9Nr5h3oAInd6HCRH7nGAob6EY/edit?gid=0#gid=0</a></p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
 
<p><em>Here's a slight modification you can test:</em></p>
<pre class=""lang-js prettyprint-override""><code>=LET(allData, transpose(B26:J29), 
     fqData, FILTER(allData, CHOOSEcols(allData, 2) &lt;&gt; """"), 
     transpose(FILTER(fqData, CHOOSEcols(fqData, 3) = ""Orange"")))
</code></pre>
<ul>
<li><strong><code>filter()</code></strong> determines which type (vertical or horizontal) filtering to go for based on the conditional true-false array. Obviously this directional factor cannot be determined in this specific scenario since its a single cell conditional value &amp; matching the row count of range &amp; conditional array seems to take precedence</li>
</ul>
<p><a href=""https://i.sstatic.net/6l4xKrBM.png"" rel=""nofollow noreferrer""><img src=""https://i.sstatic.net/6l4xKrBM.png"" alt=""enter image description here""></a></p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p><code>CHOOSEROWS(frData,3)</code> will return only one column and your error message indication that. So, you don't need <code>CHOOSEROWS()</code> function here. Just use-</p>
<pre><code>=LET(frData,B1:B4,FILTER(frData,frData=""Orange""))
</code></pre>
    </div>",2,-1,Chris Sheeler,2024-07-30 21:24:58Z
Renaming Sheet Tab Based on Cell Value,https://stackoverflow.com/questions/78813994/renaming-sheet-tab-based-on-cell-value,"I am trying to have all tabs in a spreadsheet renamed based on the value of a specific cell within each tab.
function onEdit() {
  var sheet = SpreadsheetApp.getActiveSheet();
  var oldName = sheet....","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I am trying to have all tabs in a spreadsheet renamed based on the value of a specific cell within each tab.</p>
<pre><code>function onEdit() {
  var sheet = SpreadsheetApp.getActiveSheet();
  var oldName = sheet.getName();
  var newName = sheet.getRange(1,1).getValue();
  if (newName.toString().length&gt;0 &amp;&amp; newName !== oldName) {
    sheet.setName(newName);
  }
}function myFunction() {

}
</code></pre>
<p>This works when I edit it, but I would like it to a) just do it automatically based on a trigger setting (it updates every hour based on the cell value) AND for it to happen to ALL sheets (call them '1', '2', and '3') within a spreadsheet based on the value of cell A1 in each sheet.  The above code seems to only work on one tab and only on edit.</p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>You can use a time-driven trigger.</p>
<hr>
<p>It would be best to learn about triggers in Google Apps Script by reading the official guides:</p>
<ul>
<li><a href=""https://developers.google.com/apps-script/guides/triggers"" rel=""nofollow noreferrer"">Simple Triggers</a>.</li>
<li><a href=""https://developers.google.com/apps-script/guides/triggers/installable"" rel=""nofollow noreferrer"">Installable Triggers</a>.</li>
</ul>
<p>You might also need to learn the basics of JavaScript, in this case, more specifically about loops.</p>
<p>To iterate over all the sheets, you might use the <code>SpreadsheetApp.Spreadsheet.getSheets()</code> method to get an array of sheets. Then you might use <code>Array.prototype.forEach</code> to iterate over them.</p>
<p>Example:</p>
<pre><code>function changeSheetsNames(e = {source : SpreadsheetApp.getActiveSpreadsheet() } ){

   e.source.getSheets().forEach(sheet =&gt; {
     const oldName = sheet.getName();
     const newName = sheet.getRange(1,1).getValue();
     if (newName &amp;&amp; newName !== oldName) {
       sheet.setName(newName);
     }
   });
}
</code></pre>
<p>In this case, it's best to create the trigger manually. Please follow the official guide for this.</p>
    </div>",không có câu trả lời,1,-1,RomaVictor19,2024-07-30 23:44:42Z
Google sheet Formula cell referencing,https://stackoverflow.com/questions/78805449/google-sheet-formula-cell-referencing,"I have a problem regarding cell reference. I wanted to get the data from the other tab which I already got the row number and the tab name for each.

The tab name will then be cleaned up using MID and ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I have a problem regarding cell reference. I wanted to get the data from the other tab which I already got the row number and the tab name for each.</p>
<p><img src=""https://i.sstatic.net/iVWQyCcj.png"" alt=""""></p>
<p>The tab name will then be cleaned up using MID and FIND to output the correct Bundle number</p>
<p>Expected output will be 2,3 and 4.</p>
<p>This is coming from below.</p>
<p><img src=""https://i.sstatic.net/bRhGCdUr.png"" alt=""""></p>
<p>Also, I will attached the file here: <a href=""https://docs.google.com/spreadsheets/d/1ikAH6-NKHBL9piJ4nJY_hyLdTjtPbi2VK7Ct1kIFelg/edit?gid=1255002068#gid=1255002068"" rel=""nofollow noreferrer"">https://docs.google.com/spreadsheets/d/1ikAH6-NKHBL9piJ4nJY_hyLdTjtPbi2VK7Ct1kIFelg/edit?gid=1255002068#gid=1255002068</a></p>
<p>If you can help me with this that would be great.</p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>Here's a possible solution. It only uses the numbers in column A.</p>
<pre class=""lang-cpp prettyprint-override""><code>=ARRAYFORMULA(LET(
   n,TOCOL(A2:A,1),
   MAP({""A""&amp;n,""C""&amp;n,""B""&amp;n+1,""B""&amp;n+2,""B""&amp;n+3,""B""&amp;n+4, 
        ""D""&amp;n+1,""D""&amp;n+2,""D""&amp;n+3,""D""&amp;n+4,""B""&amp;n+9,""B""&amp;n+10,
        ""B""&amp;n+11,""B""&amp;n+12,""D""&amp;n+9,""D""&amp;n+10,""D""&amp;n+11,""D""&amp;n+12},
       LAMBDA(c,LET(x,INDIRECT(""'NEW BUNDLES CONTROL IN PROGRESS'!""&amp;c),
         IF(x="""",,IF(LEFT(c)=""A"",REGEXEXTRACT(x,""\d+""),x)))))))
</code></pre>
<p>You can use this formula that doesn't use column A. The formula automatically generates the correct sequence of numbers based on where ""BUNDLE NO. #"" appears on the first sheet</p>
<pre class=""lang-cpp prettyprint-override""><code>=ARRAYFORMULA(LET(
   r,'NEW BUNDLES CONTROL IN PROGRESS'!A:A,
   n,FILTER(ROW(r),REGEXMATCH(r,""BUNDLE NO\. \d+"")),
   MAP({""A""&amp;n,""C""&amp;n,""B""&amp;n+1,""B""&amp;n+2,""B""&amp;n+3,""B""&amp;n+4, 
        ""D""&amp;n+1,""D""&amp;n+2,""D""&amp;n+3,""D""&amp;n+4,""B""&amp;n+9,""B""&amp;n+10,
        ""B""&amp;n+11,""B""&amp;n+12,""D""&amp;n+9,""D""&amp;n+10,""D""&amp;n+11,""D""&amp;n+12},
       LAMBDA(c,LET(x,INDIRECT(""'NEW BUNDLES CONTROL IN PROGRESS'!""&amp;c),
         IF(x="""",,IF(LEFT(c)=""A"",REGEXEXTRACT(x,""\d+""),x)))))))
</code></pre>
    </div>",không có câu trả lời,1,0,Patrick Nino Buquiran,2024-07-29 05:00:50Z
Limited data returned from GA4 add on to Google sheet,https://stackoverflow.com/questions/78806259/limited-data-returned-from-ga4-add-on-to-google-sheet,"When I am using the GA4 report builder add on in google sheet, the data returned is limited to 10000 rows, how can I return the whole data?
I tried to return the whole data for the selected period of ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>When I am using the GA4 report builder add on in google sheet, the data returned is limited to 10000 rows, how can I return the whole data?</p>
<p>I tried to return the whole data for the selected period of time, I got it limited to 10000 row only.</p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>You can use GA4 Magic Reports, it is free as the official add-on and has all the features working. It allows you to extend the limit beyond 10000 with field ""Offset"" in the add-on.</p>
<p>You just need to follow these steps. Let's take an example, the one shown in the screenshot below:</p>
<p>Imagine you have a report that should return 12,428 rows, but because of Google's limitation you see only the first 10,000.</p>
<p>With the offset field is possible to split the report into two pages.</p>
<p>1️⃣ Report 1: Offset blank (or 0) and Limit 10,000</p>
<p>2️⃣ Report 2: Offset 10,000 and Limit 10,000</p>
<p>In this way, the first request returns the first 10,000 rows. The second request sets the offset to the limit of the first request (10,000), so in the second report you can find the other 2,428 rows.</p>
<p>Very simple :)</p>
<p>To avoid it being seen as spam I am not including the link to the add-on, you just search for <strong>GA4 Magic Reports</strong> in the Google Workspace Marketplace as you already did with the GA4 report builder add on.</p>
    </div>",không có câu trả lời,1,0,Hayder Hassan,2024-07-29 09:18:49Z
Merging two Scripts for a custom Task Planner in Google Sheets [closed],https://stackoverflow.com/questions/78806325/merging-two-scripts-for-a-custom-task-planner-in-google-sheets,"I was creating a custom Task Planner. The requirements are like below.

In 'Task Board' tab, the rows should arrange automatically based on priority set for column 3 (Priority) and then column 6 (...","<div class=""s-prose js-post-body"" itemprop=""text"">
                    <div>
            <aside class=""s-notice s-notice__info post-notice js-post-notice mb16"" role=""status"">
        <div class=""d-flex fd-column fw-nowrap"">
            <div class=""d-flex fw-nowrap"">
                <div class=""flex--item wmn0 fl1 lh-lg"">
                    <div class=""flex--item fl1 lh-lg"">
                            <div>
                                <b>Closed.</b> This question needs <a href=""/help/minimal-reproducible-example"">debugging details</a>. It is not currently accepting answers.
                                
                            </div>
                    </div>
                </div>
            </div>
        </div>
            <hr class=""my12 outline-none baw0 bb bc-blue-400"">
        <div class=""fw-nowrap fc-black-500"">
            <div class=""d-flex fd-column lh-md"">
                <div class=""mb0 d-flex"">
                        <div class=""flex--item mr8"">
                            <svg aria-hidden=""true"" class=""svg-icon iconLightbulb"" width=""18"" height=""18"" viewbox=""0 0 18 18""><path d=""M15 6.38A6.5 6.5 0 0 0 7.78.04h-.02A6.5 6.5 0 0 0 2.05 5.6a6.3 6.3 0 0 0 2.39 5.75c.49.39.76.93.76 1.5v.24c0 1.07.89 1.9 1.92 1.9h2.75c1.04 0 1.92-.83 1.92-1.9v-.2c0-.6.26-1.15.7-1.48A6.3 6.3 0 0 0 15 6.37M4.03 5.85A4.5 4.5 0 0 1 8 2.02a4.5 4.5 0 0 1 5 4.36 4.3 4.3 0 0 1-1.72 3.44c-.98.74-1.5 1.9-1.5 3.08v.1H7.2v-.14c0-1.23-.6-2.34-1.53-3.07a4.3 4.3 0 0 1-1.64-3.94M10 18a1 1 0 0 0 0-2H7a1 1 0 1 0 0 2z""></path></svg>
                        </div>
                    <p> Edit the question to include <a href=""/help/minimal-reproducible-example"">desired behavior, a specific problem or error, and the shortest code necessary to reproduce the problem</a>. This will help others answer the question.</p>
                </div>
                    <div class=""mb0 mt6 d-flex"">
                        <p class=""ml24 pl2"">Closed <span title=""2024-07-31 03:13:15Z"" class=""relativetime"">3 days ago</span>.</p>
                    </div>
                <div class=""ml24 pl2"">

                </div>
            </div>
        </div>
            <div class=""mt24 d-flex gsx gs8"">
                    <a class=""s-btn s-btn__outlined flex--item js-post-notice-edit-post"" href=""/posts/78806325/edit"">
                        Improve this question
                    </a>
            </div>
</aside>

    </div>

<p>I was creating a custom Task Planner. The requirements are like below.</p>
<ol>
<li>In 'Task Board' tab, the rows should arrange automatically based on priority set for column 3 (Priority) and then column 6 (Overdue Rank).</li>
<li>Once Status updated on column 7 (Status), the entire row should move from current tab to their destination tab and vice-versa.</li>
</ol>
<p>Both the scripts 'MoveRow' &amp; 'AutoSort' working fine when other script is not present. Need to combine them, so both the requiremnts are addressed.</p>
<p><strong>Script MoveRow:</strong></p>
<pre><code>function onEdit(e){
let range = e.range;
let col = range.getColumn();
let row = range.getRow();
let val = range.getValue();
let source = e.source.getActiveSheet();

if (col == 6 &amp;&amp; val != ''){
let ss = SpreadsheetApp.getActiveSpreadsheet();
let sheet = ss.getSheetByName(source.getName());
let targetSheet = ss.getSheetByName(val);
let data = sheet.getRange(row,1,1,sheet.getLastColumn()).getValues();
data[0][0] = '';
targetSheet.appendRow(data[0]);
sheet.deleteRow(row);
  
  }
}
</code></pre>
<p><strong>Script: AutoSort</strong></p>
<pre><code>function onEdit(e) {
var sorts = [
{sheet: 'Task Board', range:'A2:H', cols: [3,6]},
{sheet: 'Data', range:'A2:E', cols: [1]},
{sheet: 'Data', range:'A2:E', cols: [2]}
];

var ss = SpreadsheetApp.getActiveSpreadsheet();

for (var sort of sorts) {
var sheet = ss.getSheetByName(sort.sheet);
var range = sheet.getRange(sort.range + sheet.getLastRow());
var sort_order = [];
for (var col of sort.cols) {
sort_order.push({column: col, ascending: true})
}

range.sort(sort_order);

}

function onEdit(e){

autoSort(e)

}
}
</code></pre>
<p>File Link: <a href=""https://docs.google.com/spreadsheets/d/14YfxfvDMqIa6Wn3gg05GmE5OhuW6NajW6dwNe5ghidM/edit?usp=sharing"" rel=""nofollow noreferrer"">https://docs.google.com/spreadsheets/d/14YfxfvDMqIa6Wn3gg05GmE5OhuW6NajW6dwNe5ghidM/edit?usp=sharing</a></p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,-2,Eternal Quest,2024-07-29 09:34:38Z
How to extract partial data from one sheet to another using a single formula in Google Sheets,https://stackoverflow.com/questions/78806735/how-to-extract-partial-data-from-one-sheet-to-another-using-a-single-formula-in,"So I have two sheets, Expenses and Tax Deductibles. The Expenses sheet has it's data filled via a Google form where I track date of purchase, the category it fits, whether it's tax deductible, etc. ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>So I have two sheets, Expenses and Tax Deductibles. The Expenses sheet has it's data filled via a Google form where I track date of purchase, the category it fits, whether it's tax deductible, etc. The ""Is this tax deductible"" column filled with ""Yes"" or ""No"" data. I want to take all the cells that have ""Yes"" and take all the data from those rows and populate the Tax Deductibles sheet with it.</p>
<p>The Tax Deductibles sheet would sort this data by category and date (Specifically month by month) and display the totals for each category for each month. Dates are UK Format.</p>
<p>This is how the Expenses Sheet looks:</p>
<div class=""s-table-container""><table class=""s-table"">
<thead>
<tr>
<th>Date</th>
<th>Item</th>
<th>Deductible?</th>
<th>Category</th>
<th>Amount</th>
</tr>
</thead>
<tbody>
<tr>
<td>24/05/24</td>
<td>Phone</td>
<td>No</td>
<td>Bills</td>
<td>£10</td>
</tr>
<tr>
<td>25/05/24</td>
<td>Accountant</td>
<td>Yes</td>
<td>Bills</td>
<td>£200</td>
</tr>
<tr>
<td>26/05/24</td>
<td>Gas</td>
<td>Yes</td>
<td>Bills</td>
<td>£75</td>
</tr>
<tr>
<td>01/06/24</td>
<td>Apples</td>
<td>No</td>
<td>Food</td>
<td>£1</td>
</tr>
<tr>
<td>01/06/24</td>
<td>Lunch</td>
<td>Yes</td>
<td>Food</td>
<td>£15</td>
</tr>
<tr>
<td>13/07/24</td>
<td>Electric</td>
<td>Yes</td>
<td>Bills</td>
<td>£40</td>
</tr>
</tbody>
</table></div>
<p>And this is how the Tax Deductibles Sheet currently looks:</p>
<div class=""s-table-container""><table class=""s-table"">
<thead>
<tr>
<th>Month</th>
<th>Bills</th>
<th>Food</th>
<th>Travel</th>
<th>Other</th>
</tr>
</thead>
<tbody>
<tr>
<td>May 24</td>
<td>£275</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
</tr>
<tr>
<td>June 24</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
</tr>
<tr>
<td>July 24</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
</tr>
<tr>
<td>Sep 24</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
</tr>
<tr>
<td>Oct 24</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
</tr>
</tbody>
</table></div>
<p>But this is how Tax Deductibles should look:</p>
<div class=""s-table-container""><table class=""s-table"">
<thead>
<tr>
<th>Month</th>
<th>Bills</th>
<th>Food</th>
<th>Travel</th>
<th>Other</th>
</tr>
</thead>
<tbody>
<tr>
<td>May 24</td>
<td>£275</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
</tr>
<tr>
<td>June 24</td>
<td>£0</td>
<td>£15</td>
<td>£0</td>
<td>£0</td>
</tr>
<tr>
<td>July 24</td>
<td>£40</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
</tr>
<tr>
<td>Sep 24</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
</tr>
<tr>
<td>Oct 24</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
<td>£0</td>
</tr>
</tbody>
</table></div>
<p>Here's a copy of the sheet I'm using: <a href=""https://docs.google.com/spreadsheets/d/1Y079euBk63RYcgFOPjBFwMlPi53SUAIgZ-h69_o9Hsc/edit?usp=sharing"" rel=""nofollow noreferrer"">https://docs.google.com/spreadsheets/d/1Y079euBk63RYcgFOPjBFwMlPi53SUAIgZ-h69_o9Hsc/edit?usp=sharing</a></p>
<p>The formula I'm currently using in the Tax Deductibles sheet is as follows:</p>
<pre><code>=sumifs(Expenses!$F:$F,Expenses!$E:$E,$B1,Expenses!$D:$D,""Yes"",index(eomonth(Expenses!$B:$B,)),eomonth(A$2,))
</code></pre>
<p>So this works for the first cell (B2 in the Google sheet), but it doesn't seem to work when expanded across other cells in the same column or row (Or any others for that matter).</p>
<p>The numbers in the tables here are slightly different than the data in the actual sheet I've linked but the point is still the same.</p>
<p>For reference I've added some images of the actual tables so you can see how they actually look:</p>
<p><a href=""https://i.sstatic.net/cWjrjnbg.png"" rel=""nofollow noreferrer"">Tax Deductibles Sheet</a></p>
<p><a href=""https://i.sstatic.net/wij24IdY.png"" rel=""nofollow noreferrer"">Expenses Sheet</a></p>
<p>Any help would greatly appreciated as this has been stumping me for a while. Thanks!</p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,Kristian Burnett,2024-07-29 11:08:37Z
Customize y-axis,https://stackoverflow.com/questions/78807266/customize-y-axis,"I have a few charts with data and I want the y-axis to autofit to the data + a buffer of 10%.
The customize tools don't have this option. I don't have any coding background, but with the help of ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I have a few charts with data and I want the y-axis to autofit to the data + a buffer of 10%.</p>
<p>The customize tools don't have this option. I don't have any coding background, but with the help of ChatGPT I made this custom script that is yet to work:</p>
<pre><code>function setDynamicYAxis() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var chart = sheet.getCharts()[0]; // Assumes the chart you want to edit is the first one
  var dataRange = sheet.getDataRange();
  var values = dataRange.getValues();
   
  // Find the maximum value in the data range
  var maxValue = 0;
  for (var i = 0; i &lt; values.length; i++) {
    for (var j = 0; j &lt; values[i].length; j++) {
      if (values[i][j] &gt; maxValue) {
        maxValue = values[i][j];
      }
    }
  }

  // Set the new max value with a buffer (e.g., 10% higher)
  var buffer = maxValue * 0.1;
  var newMax = maxValue + buffer;

  // Modify the chart's y-axis maximum value
  var updatedChart = chart.modify()
    .setOption('vAxis.maxValue', newMax)
    .build();

  sheet.updateChart(updatedChart);
}
</code></pre>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>You can get the min or max by flattening the matrix.</p>
<p></p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>const values = [
  [1, 3, 8],
  [2, 9, 5],
  [7, 4, 0]
];

const flattenedValues = values.flatMap(x =&gt; x);
const min = Math.min(...flattenedValues);
const max = Math.max(...flattenedValues);

console.log({ min, max });</code></pre>
</div>
</div>

<p><strong>Question:</strong> What does your dataset look like? I don't think you want the x-axis data in your range. Are you plotting multiple y-axis in one chart?</p>
<p>If your range includes headers you will have to slice them off:</p>
<pre class=""lang-js prettyprint-override""><code>// Find the maximum value in the data range (exclude headers)
var maxValue = Math.max(...flattenedValues = values.slice(1).flatMap(x =&gt; x));
</code></pre>
<p>Here is the working code (verified)</p>
<pre class=""lang-js prettyprint-override""><code>function setDynamicYAxis() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var chart = sheet.getCharts()[0]; // Assumes the chart you want to edit is the first one
  var dataRange = sheet.getDataRange();
  var values = dataRange.getValues();
   
  // Find the maximum value in the data range (exclude headers)
  var maxValue = Math.max(...flattenedValues = values.slice(1).flatMap(x =&gt; x));

  // Set the new max value with a buffer (e.g., 10% higher)
  var buffer = maxValue * 0.1;
  var newMax = maxValue + buffer;

  // Modify the chart's y-axis maximum value
  var updatedChart = chart.modify()
    .setOption('vAxis.maxValue', newMax)
    .build();

  sheet.updateChart(updatedChart);
}
</code></pre>
<p>Here is my sheet dataset that my chart used as a range:</p>
<div class=""s-table-container""><table class=""s-table"">
<thead>
<tr>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>6</td>
</tr>
<tr>
<td>2</td>
<td>7</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>99</td>
</tr>
<tr>
<td>5</td>
<td>9</td>
</tr>
<tr>
<td>6</td>
<td>3</td>
</tr>
<tr>
<td>7</td>
<td>2</td>
</tr>
<tr>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>9</td>
<td>7</td>
</tr>
<tr>
<td>10</td>
<td>4</td>
</tr>
</tbody>
</table></div>
<p>Here is the output:</p>
<p><a href=""https://i.sstatic.net/xF6FIOni.png"" rel=""nofollow noreferrer""><img src=""https://i.sstatic.net/xF6FIOni.png"" alt=""enter image description here""></a></p>
<p><strong>Note:</strong> The <code>buffer</code> is only used when setting the <code>newMax</code>, so you could remove this assignment and write this instead:</p>
<pre class=""lang-js prettyprint-override""><code>// Set the new max value with a buffer (e.g., 10% higher)
var newMax = Math.ceil(maxValue * 1.1);
</code></pre>
    </div>",không có câu trả lời,1,1,Joop de Groot,2024-07-29 13:09:23Z
How to return value with matching week day to all future week ranges,https://stackoverflow.com/questions/78807344/how-to-return-value-with-matching-week-day-to-all-future-week-ranges,"Column B are dates, beginning from B2 e.g 29 Jul 2024
Column C are amounts, being from C2 e.g. $100.00
Row 1 are date week ranges beginning from D1 e.g. 29 Jul 2024 - 04 Aug 2024

What I'm trying to ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<ul>
<li>Column B are dates, beginning from B2 e.g 29 Jul 2024</li>
<li>Column C are amounts, being from C2 e.g. $100.00</li>
<li>Row 1 are date week ranges beginning from D1 e.g. 29 Jul 2024 - 04 Aug 2024</li>
</ul>
<p>What I'm trying to do is auto populate the future week range, with amount from C2, in which B2 day <code>'dd'</code> would fall for all matching week ranges on row 2.</p>
<p>For instance, I would expect to see amount $100.00, with date 29 Jul 2024, auto populate in week ranges 26 Aug 2024 - 01 Sep 2024, 23 Sep 2024 - 29 Sep 2024, 28 Oct - 03 Nov 2024 etc</p>
<p>I tried a few array formulae but not fully working. Also tried using variations of IF statements  by splitting beginning and end dates of ranges into separate rows but I think text vs date is throwing things off.</p>
<p>Below is when range beginning and end are split to rows 2 and 3</p>
<p><code>ARRAYFORMULA(IF(AND(DAY($B$4)&gt;=DAY(D2),DAY($B$4)&lt;=DAY(D3)),$C$4,"""")</code></p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,Protractor,2024-07-29 13:25:50Z
How can i read and write to cells in the same function?,https://stackoverflow.com/questions/78807472/how-can-i-read-and-write-to-cells-in-the-same-function,"I would like to read the spreadsheet cell H2 in the same function blackList
With this script, i am currently writing to cell H1. I would like to read cell H2 as well.
This is my updated script:
const {...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I would like to read the spreadsheet cell H2 in the same function <code>blackList</code></p>
<p>With this script, i am currently writing to cell H1. I would like to read cell H2 as well.</p>
<p>This is my <strong>updated</strong> script:</p>
<pre><code>const { setTimeout } = require(""timers/promises""); // cause a delay if needed

async function blackList() { 
    const sheets = google.sheets({ version: ""v4"", auth });
    const spreadsheetId = ""myidhere"";
  
    const sheetName = ""BOTDATA"";
    const cells = [""H1""];
    const valueInputOption = ""USER_ENTERED"";
    const userInput = interaction.options.get('steamid').value;
    await sheets.spreadsheets.values.update({
      spreadsheetId,
      range: `'${sheetName}'!${cells[0]}`,
      resource: { values: [[userInput]] },
      valueInputOption,
    });
     await setTimeout(1000); // set time on delay if needed

    const obj = await sheets.spreadsheets.values.get({spreadsheetId, range: `'${sheetName}'!H2`});
    const value = obj.data.values[0][0];
   // console.log(value);
    return value;
  }

  (async()=&gt;{

if (interaction.commandName === 'checkbl') {
    //blackList();
    const userInput = interaction.options.get('steamid').value;
    const value = await blackList()
    const bl = new EmbedBuilder()
    .setTitle('Blacklist Checker')
    .setDescription(`${userInput} is ${value}`)
    .setColor('Red')
    .setThumbnail('https://i.imgur.com/9GKhYQf.png')
    .setFooter({text: 'DroneOS', iconURL: 'https://i.imgur.com/9GKhYQf.png'})
    .setTimestamp()

    interaction.reply({ embeds: [bl]});

}

})()
</code></pre>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>I believe your goal is as follows.</p>
<ul>
<li>You want to put a value to a cell ""H1"" and want to retrieve a value from ""H2"". From <code>Depending on the value of the cell 'H1' is when the userInput is updated, it will change cell ""H2"" Value. And i would like to display H2.</code>, it seems that the value ""H2"" is changed by the value of ""H1"".</li>
</ul>
<p>In this case, how about the following modification?</p>
<h3>Modified script:</h3>
<pre class=""lang-js prettyprint-override""><code>const { setTimeout } = require(""timers/promises""); // added

async function blackList() {
  const sheets = google.sheets({ version: ""v4"", auth });
  const spreadsheetId = ""myIdhere"";

  const sheetName = ""BOTDATA"";
  const cells = [""H1""];
  const valueInputOption = ""USER_ENTERED"";
  const userInput = interaction.options.get(""steamid"").value;
  await sheets.spreadsheets.values.update({
    spreadsheetId,
    range: `'${sheetName}'!${cells[0]}`,
    resource: { values: [[userInput]] },
    valueInputOption,
  });

  await setTimeout(2000); // Please adjust this value to your situation.

  const obj = await sheets.spreadsheets.values.get({spreadsheetId, range: `'${sheetName}'!H2`});
  const value = obj.data.values[0][0];
  console.log(value);
}
</code></pre>
<ul>
<li>In this modification, after a value was put into the cell ""H1"", the cell value of ""H2"" is retrieved.</li>
<li>In this modification, the wait time is set for calculating the formula of ""H2"". But, I have no information about your actual situation. So, I'm not sure whether <code>await setTimeout(2000);</code> is required to be used. So, please test with and without it, and decide whether you use it.</li>
</ul>
<h3>Note:</h3>
<ul>
<li><code>setTimeout</code> can be used after Node.js 16. Please be careful about this.</li>
</ul>
    </div>",không có câu trả lời,1,0,famq,2024-07-29 13:47:00Z
Google Sheets Event to Open Insert Image function,https://stackoverflow.com/questions/78807840/google-sheets-event-to-open-insert-image-function,"I am creating a form for work that when my employees fill it out, they have the option to add photos to their report. I'm trying to make it slightly easier by combining so many cells into one and that ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I am creating a form for work that when my employees fill it out, they have the option to add photos to their report. I'm trying to make it slightly easier by combining so many cells into one and that when they click that group of cells, it will automatically open the insert image over cell function. I don't really know where to start.</p>
<p>Also,
I'd like to create a button they can click to ""submit"" the form and it load the ""Email"" prompt found under the File menu.</p>
<p>Are either of these possible or am I just blowing smoke in the wind?</p>
<p>Not sure where to begin. I have searched and searched but have not found any answers that meet my dilemma.</p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,Derek Sullivan,2024-07-29 15:07:22Z
Hyperlink between Google Sheets list and a specific website,https://stackoverflow.com/questions/78808036/hyperlink-between-google-sheets-list-and-a-specific-website,"I'm trying to create a dynamic list of keywords which allows to automatically search for every keyword in a specific website.
For instance, I have got a list:
The first keyword is ""Abies alba ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I'm trying to create a dynamic list of keywords which allows to automatically search for every keyword in a specific website.</p>
<p>For instance, I have got a list:</p>
<p>The first keyword is ""Abies alba Mill.""</p>
<div class=""s-table-container""><table class=""s-table"">
<thead>
<tr>
<th>Keywords</th>
<th>Links</th>
</tr>
</thead>
<tbody>
<tr>
<td>Abies alba Mill.</td>
<td>Link 1</td>
</tr>
<tr>
<td>Abies nebrodensis (Lojac.) Mattei</td>
<td>Link 2</td>
</tr>
</tbody>
</table></div>
<p>I would like to create a system that automatically search each keyword on google in that specific website (site: actaplantarum.org) and then puts the link of the webpage referred to the keyword.
In other words, if I should do it manually: My first keyword is ""Abies alba Mill.""</p>
<ol>
<li>I would search on Google: ""site:actaplantarum.org/flora abies alba Mill.""</li>
<li>I would copy the related link and I would paste it in the adjacent cell (I wrote ""Link 1"" for this thread), namely actaplantarum.org/flora/flora_info.php?id=149</li>
</ol>
<p>The list is very long, so I'm trying to find a solution which automatically looks for every keyword and put the specific link to it.</p>
<p>On the internet I there are some scripts that allow to search on Google for the keyword but I was not able to find anything that allows to search in a website and link the webpage related to it.</p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,0,Tommaso Se,2024-07-29 15:53:55Z
"Question on google sheets URL from another language, like VB",https://stackoverflow.com/questions/78808448/question-on-google-sheets-url-from-another-language-like-vb,"https://docs.google.com/spreadsheets/d/[myworksheet]/edit?gid=0#gid=0
In this line what does /d/ do and what other values could be there?  Same questions for /edit, ?gid and #gid.  (note-  I could not ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p><a href=""https://docs.google.com/spreadsheets/d/%5Bmyworksheet%5D/edit?gid=0#gid=0"" rel=""nofollow noreferrer"">https://docs.google.com/spreadsheets/d/[myworksheet]/edit?gid=0#gid=0</a>
In this line what does /d/ do and what other values could be there?  Same questions for /edit, ?gid and #gid.  (note-  I could not find detailed answers at: <a href=""https://developers.google.com/sheets/api/guides/concepts"" rel=""nofollow noreferrer"">https://developers.google.com/sheets/api/guides/concepts</a>)</p>
<p>Trying to understand how to update a google worksheet from Visual BASIC.</p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p><code>/d</code> basically never changes, its purpose is to indicate that what follows is the document ID.</p>
<p><code>/edit</code> just tells you the document is in edit mode, it could be <code>/view</code> (viewer mode) or <code>/copy</code> (when the user wants to make a copy)</p>
<p>The <code>gid</code> is a unique identifier for each sheet within the document. <code>?gid</code> specifies the current sheet. <code>#gid</code> is used to set the initial sheet displayed in the user's browser. Both of those are unique numeric identifiers.</p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>Basically; you need to execute a POST request on VB (or VBA side) to the GoogleSheets and this request must be handled by a GET method written in the Google Sheets' script module.</p>
    </div>",2,0,Brooks,2024-07-29 17:52:12Z
Create a formula that gathers information from one sheet and inputs it in another based on one cell,https://stackoverflow.com/questions/78808707/create-a-formula-that-gathers-information-from-one-sheet-and-inputs-it-in-anothe,"I have two spreadsheets. I am scanning items onto sheet 2 under column A.
On Sheet 1 I have all the information for Inventory. The Columns I will be using from sheet a is Column D and Column AA. So ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I have two spreadsheets. I am scanning items onto sheet 2 under column A.
On Sheet 1 I have all the information for Inventory. The Columns I will be using from sheet a is Column D and Column AA. So when I am scanning items on sheet to and a number from Column AA matched from Sheet 1 it will pull the information from Column D from the same row and be put in column C on sheet 2. I have a formulas but its not pulling the information needed</p>
<p>Not Found appears but there are matches
=IF(A2="""", """", IFERROR(VLOOKUP(A2, Woo!$D$2:$AA$1000, 4, FALSE), ""Not Found""))</p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>From your description, it seems that you're trying to look into column AA and returning value from column D; if that is the case, VLOOKUP in this way wouldn't be helpful, because it looks in the first column of the range (D) and return from the 4th column (G).</p>
<p>I suggest you to use <a href=""https://support.google.com/docs/answer/12405947?hl=en"" rel=""nofollow noreferrer"">XLOOKUP</a>, that you can set an input and an output range, like this:</p>
<pre><code>=IF(A2="""", """", IFERROR(XLOOKUP(A2, Woo!$AA$2:$AA$1000,Woo!$D$2:$D$1000), ""Not Found""))
</code></pre>
<p>In fact, you can use this function to return ""Not found"" without IFERROR:</p>
<pre><code>=IF(A2="""", """", XLOOKUP(A2, Woo!$AA$2:$AA$1000,Woo!$D$2:$D$1000,""Not found""))
</code></pre>
    </div>",không có câu trả lời,1,0,CYL,2024-07-29 19:09:08Z
App scripts: Script is not pulling in formula result,https://stackoverflow.com/questions/78808947/app-scripts-script-is-not-pulling-in-formula-result,"I have found this forum to be very helpful.. reading through other issues and finding my solution. So far, I haven't found a solution to these two problems.
This script is used to create a document ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I have found this forum to be very helpful.. reading through other issues and finding my solution. So far, I haven't found a solution to these two problems.</p>
<p>This script is used to create a document from my spreadsheet. It works exactly as I expected, except for:</p>
<ol>
<li>Dates/Times are being entered wrong on the new document. I see solutions but they confuse me how to incorporate them into my script.</li>
<li>The same script is not pulling the 'trip number' value from the trip number column. It has a complex formula to generate trip number as I need it in a particular format. Honestly, I don't know how the heck it works, someone else from a different forum helped with that issue.</li>
</ol>
<p>I also have a create event script that uses the same sheet that is working perfectly. It sees the trip number and pulls it into the description of the event as expected.</p>
<p>Here is my <a href=""https://docs.google.com/spreadsheets/d/1jO8auzYZ6drlGi3m7lon6gHTBVboDNgH5e0x4OwQoAA/edit?usp=sharing"" rel=""nofollow noreferrer"">test sheet</a>.</p>
<p>Here is my code:</p>
<pre><code>function createNewGoogleDocs() {
  const googleDocTemplate = DriveApp.getFileById('1kOLZvB7ZEspV1TJQi5oih_ZKVQuzoI5m19gHjCz7atw');
  const destinationFolder = DriveApp.getFolderById('1022a6xSO_Bh9zNilY2O6nb8dirHFJb8m');
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Mirror');
  const rows = sheet.getDataRange().getValues();

  rows.forEach(function(row, index){
     if (index === 0) return;
     if (row[29]) return;
    const copy = googleDocTemplate.makeCopy(`${row[18]}, Trip Sheet` , destinationFolder)
    const doc = DocumentApp.openById(copy.getId())
    const body = doc.getBody();

    body.replaceText('{{tripcategory}}', row[3]);
    body.replaceText('{{group}}', row[6]);
    body.replaceText('{{pickuplocation}}', row[7]);
    body.replaceText('{{destinationname}}', row[8]);
    body.replaceText('{{destinationaddress}}', row[9]);
    body.replaceText('{{leadsponsor}}', row[10]);
    body.replaceText('{{leadsponsorcell}}', row[11]);
    body.replaceText('{{studentcount}}', row[12]);
    body.replaceText('{{adultcount}}', row[13]);
    body.replaceText('{{comments}}', row[16]);
    body.replaceText('{{tripnumber}}', row[19]);
    body.replaceText('{{departdate}}', row[21]);
    body.replaceText('{{departtime}}', row[22]);
    body.replaceText('{{checkIn}}', row[23]);

    doc.saveAndClose();
    const url = doc.getUrl();
    sheet.getRange(index + 1, 29).setValue(url)
        
  })
  
}
</code></pre>
<p>I've been reading pages and watching videos. I'm very confused and don't know anything about javascript or other forms of coding.</p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>Ok, so my advise is to keep the <code>const rows = sheet.getDataRange().getValues();</code> line. Do not change it to getDisplayValues(), instead use the values to create and format the strings of text that you want as an output.</p>
<p>First in your mirror sheet use this formula for the cells U2 and V2 <code>=ARRAYFORMULA('Form Responses 1'!E2:E)</code> that way we make sure that the values in those cells are date and time values.</p>
<p>Then in your Google Apps Script code put the next lines before the body.replaceText block:</p>
<pre><code>// we create a variable with the value of tripnumber turned into string as an integer value
var strtripnumber = Utilities.formatString(""%d"", row[18]);
// we create a variable that contains the date and time of departure
var ddate = new Date(row[20]);
// then use that variable to create two strings, one representing the date and one representing the time
var strddate = Utilities.formatDate(ddate, ""GMT-5"", ""MM/dd/yyyy"");
var strdtime = Utilities.formatDate(ddate, ""GMT-5"", ""HH:mm"");
</code></pre>
<p>After that, change the replaceText lines for tripnumber, departdate and departtime like this:</p>
<pre><code>body.replaceText('{{tripnumber}}', strtripnumber);
body.replaceText('{{departdate}}', strddate);
body.replaceText('{{departtime}}', strdtime);
</code></pre>
<p>Keep in mind that I'm using the column numbers as they are in your test file, if you have a main file with the columns in different order you should change them.</p>
    </div>",không có câu trả lời,1,0,Victoria Kirkpatrick,2024-07-29 20:31:45Z
Function does not run as result of a Browser.msgBox prompt response,https://stackoverflow.com/questions/78809187/function-does-not-run-as-result-of-a-browser-msgbox-prompt-response,"I have a big red button in my google sheet that has ""Clear Notes"" written on it, and I have it attached to a function called ""ClearCells."" This ClearCells function was the first ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>I have a big red button in my google sheet that has ""Clear Notes"" written on it, and I have it attached to a function called ""ClearCells."" This ClearCells function was the first AppScript I set up, which worked perfectly fine. Then I needed to set up a prompt pop up that would confirm if the user actually meant to click the button, or if it was a mistake. I need the ClearCells function to run only when the response to the Browser.msgBox prompt is ""yes"", and to not run the function when the response is ""no"" or if the prompt is closed using the close button.</p>
<p>Below is the AppScript I have so far. Currently when I click on the ""Clear Notes"" button, it returns with the error message: ""Script function ClearCells could not be found.""</p>
<pre><code>var response = Browser.msgBox('One Second!', 'This will delete all weekly notes. Are you sure?', Browser.Buttons.YES_NO);
if (response=='yes') {
  function ClearCells() {
    var sheet = SpreadsheetApp.getActive().getSheetByName('ExampleSheet1');
    sheet.getRange('D3:D').clearContent();}
} else {
  Logger.log('The user clicked ""No"" or the dialog\'s close button.');
}
</code></pre>
<p>I tried creating another AppScript project that contains JUST the ClearCells function, and having both projects actually makes the button click proceed to the Browser.msgBox prompt. But the problem is that it runs the function, regardless of whether I click yes or no.</p>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>The problem is that the function declaration is not on the top level.</p>
<p>On the other hand, it's unclear if the code included in the question is at the top level or inside the function declaration block.</p>
<p>To fix the error, move the clearCells function to the top level. You should see this function name in the Google Apps Script Editor toolbar dropdown. See the below image:</p>
<p><a href=""https://i.sstatic.net/lGbTzXC9.png"" rel=""nofollow noreferrer""><img src=""https://i.sstatic.net/lGbTzXC9.png"" alt=""Google Apps Script Editor showing the editor and the clearCells function""></a></p>
    </div>",không có câu trả lời,1,0,Yong Lee,2024-07-29 22:11:22Z
Google Sheet Sequential Conditional formatting fails,https://stackoverflow.com/questions/78809548/google-sheet-sequential-conditional-formatting-fails,"I have 2 conditional formatting rules in Google sheets that looks for specific counties and applies formatting:
=REGEXMATCH($U2, ""Brown|Calumet|Chippewa|Clark|Columbia|Dane|Dodge|Door|Dunn|Eau ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p><a href=""https://i.sstatic.net/lvInwD9F.png"" rel=""nofollow noreferrer""><img src=""https://i.sstatic.net/lvInwD9F.png"" alt=""enter image description here""></a></p>
<p>I have 2 conditional formatting rules in Google sheets that looks for specific counties and applies formatting:</p>
<pre><code>=REGEXMATCH($U2, ""Brown|Calumet|Chippewa|Clark|Columbia|Dane|Dodge|Door|Dunn|Eau Claire|Fond du Lac|Green|Green Lake|Iowa|Jefferson|Kenosha|Kewaunee|Lake|Milwaukee|Oconto|Outagamie|Ozaukee|Pepin|Racine|Rock|Sauk|Shawano|Trempealeau|Walworth|Washington|Waukesha|Waupaca|Winnebago"") -- Applies BOLD

=REGEXMATCH($U2, ""Kewaunee|Vilas|Adams|Lincoln|Oconto|Juneau|Ashland|Portage|Marathon|Wood|Rock|Waushara|Langlade|Columbia|Richland|Forest|Burnett|Marquette|Crawford|Monroe|Manitowoc|Jefferson|Lafayette|St. Croix|Outagamie|Shawano|Jackson"") -- Applies UNDERLINING
</code></pre>
<p>The range for both is the same.</p>
<p>I've highlighted the row of interest in blue in the screenshot. As you can see the bolding rule is applied but not the underlining. You can see elsewhere in the screenshot that both underlining and bolding work separately</p>
<p>Why not? How can I get both working on this row?</p>
    </div>",chưa có câu trả lời,không có câu trả lời,0,1,user1592380,2024-07-30 02:00:37Z
How do I create a function that deletes a row when checkbox is true,https://stackoverflow.com/questions/78810052/how-do-i-create-a-function-that-deletes-a-row-when-checkbox-is-true,"Basically I have a spreadsheet where I need a code that deletes the row that I check the checkbox in. Now I have code that is doing this, but the code runs across the whole spreadsheet not just the 2 ...","<div class=""s-prose js-post-body"" itemprop=""text"">
                
<p>Basically I have a spreadsheet where I need a code that deletes the row that I check the checkbox in. Now I have code that is doing this, but the code runs across the whole spreadsheet not just the 2 specific sheets. Therefore, when something on another sheet is marked true or 1 in the area that is checked the code activates and causes issues. This code runs on an on edit trigger as well.</p>
<p>I have tried this block of code which does delete the row as I mentioned but runs no matter the sheet im on. Now I tried to add a checkSheet function as you can see but did not work (may of done it wrong).</p>
<pre><code>function deleteCheckedBoxes() {

checkSheet();

const sheet = SpreadsheetApp.getActiveSheet();

const activeRange = sheet.getActiveRange();
const activeRow = activeRange.getRow();
const activeColumn = activeRange.getColumn();

let rangeUpdatedValue =  activeRange.getValue();

if(activeColumn == 5 &amp;&amp; rangeUpdatedValue == true){

  sheet.deleteRow(activeRow);

}
</code></pre>
    </div>","<div class=""s-prose js-post-body"" itemprop=""text"">
<p>I believe your goal is as follows.</p>
<ul>
<li>You want to delete the row when the function <code>deleteCheckedBoxes</code> is run.</li>
<li>You want to run the script to the specific sheets.</li>
<li>From your showing script, I guessed that you wanted to directly run the function <code>deleteCheckedBoxes</code> although you have already installed the function as the OnEdit trigger.</li>
</ul>
<p>In this case, how about the following modification?</p>
<h3>Modified script:</h3>
<p>Please set the sheet names to <code>sheetNames</code> of the sheets you want to run the script.</p>
<pre class=""lang-js prettyprint-override""><code>function deleteCheckedBoxes() {
  const sheetNames = [""Sheet1"", ""Sheet2"",,,]; // Please set your sheet names you want to use this script.

  const sheet = SpreadsheetApp.getActiveSheet();
  if (sheetNames.includes(sheet.getSheetName())) {
    const activeRange = sheet.getActiveRange();
    const activeRow = activeRange.getRow();
    const activeColumn = activeRange.getColumn();
    if (activeColumn == 5 &amp;&amp; activeRange.isChecked()) {
      sheet.deleteRow(activeRow);
    }
  }
}
</code></pre>
<ul>
<li>When this script is run, the script is run to the sheet names of <code>sheetNames</code>.</li>
<li>In order to confirm the checkbox, <code>isChecked()</code> can also be used.</li>
</ul>
<h3>References:</h3>
<ul>
<li><a href=""https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes"" rel=""nofollow noreferrer"">includes()</a></li>
<li><a href=""https://developers.google.com/apps-script/reference/spreadsheet/range#ischecked"" rel=""nofollow noreferrer"">isChecked()</a></li>
</ul>
    </div>",không có câu trả lời,1,1,Narukami,2024-07-30 06:19:56Z
